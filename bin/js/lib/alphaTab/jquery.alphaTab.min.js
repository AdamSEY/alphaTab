var alphaTabWrapper;
(function(e){alphaTabWrapper=function(i,j){var a=this;this.el=i=e(i);this.factory=new alphatab.tablature.model.DrawingSongModelFactory;var g=e('script[src*="/alphaTab.js"]');if(g.length==0)g=e('script[src*="/alphaTab.min.js"]');var h="";if(g.length){h=function(b){var c=location,f,d;if(/^\w+:/.test(b))return b;f=c.protocol+"//"+c.host;if(b.indexOf("/")==0)return f+b;c=c.pathname.replace(/\/[^\/]*$/,"");if(d=b.match(/\.\.\//g)){b=b.substring(d.length*3);for(d=d.length;d--;)c=c.substring(0,c.lastIndexOf("/"))}return f+
c+"/"+b}(g.attr("src"));h=h.substr(0,h.lastIndexOf("/"))}this.options=e.extend({base:h,file:null,track:0,loadCallback:null,errorCallback:null,error:"Load a file to display the tablature",zoom:1.1,width:600,height:200,autoSize:true,staves:null,layout:null,context:"canvas"},j);if(this.options.autoSize=="maxWidth")this.options.width=i.width();this.loadAlphaTex=function(b){try{a.tablature.isError=false;var c=new alphatab.file.alphatex.AlphaTexParser,f=new alphatab.io.StringInputStream(b);c.init(f,a.factory);
var d=c.readSong();alphatab.file.SongReader.finalize(d);l(d)}catch(n){m(n)}};this.loadFile=function(b){try{alphatab.file.SongLoader.loadSong(b,a.factory,l)}catch(c){m(c)}};this.loadCallbacks=[];var l=function(b){a.options.loadCallback&&a.options.loadCallback(b);try{a.tablature.setTrack(b.tracks[a.options.track])}catch(c){alert(c)}for(var f=0;f<a.loadCallbacks.length;f++)a.loadCallbacks[f](b)},m=function(b){if(b instanceof alphatab.file.FileFormatException)b=b.message;if(a.options.errorCallback)a.options.errorCallback(b);
else{a.tablature.isError=true;a.tablature.updateDisplay=true;a.tablature.errorMessage=b;a.tablature.invalidate()}};g=function(){document.createElement("canvas");a.canvas=e('<canvas width="'+a.options.width+'" height="'+a.options.height+'" class="alphaTabSurface"></canvas>');a.el.append(a.canvas);a.canvas=a.canvas[0];if(e.browser.msie)if(e.browser.version<9)a.canvas=G_vmlCanvasManager.initElement(function(b){var c=b.outerHTML,f=b.ownerDocument.createElement(c);if(c.slice(-2)!="/>"){c="/"+b.tagName;
for(var d;(d=b.nextSibling)&&d.tagName!=c;)d.removeNode();d&&d.removeNode()}b.parentNode.replaceChild(f,b);return f}(a.canvas));return a.canvasWrapper=a.canvas};this.contents=e.trim(i.text());i.html("");h=null;if(this.options.context=="canvas")h=g();else{a.canvasWrapper=e('<div class="alphaTabCanvasWrapper"></div>');a.canvas=a.canvasWrapper;a.el.append(a.canvasWrapper);h=this.options.context}var k=null;if(this.options.staves!=null)if(this.options.staves.constructor==Array)k=this.options.staves;else{k=
[];e.each(this.options.staves,function(b){k.push(b)})}this.tablature=new alphatab.tablature.Tablature(h,k,this.options.error);this.tablature.autoSizeWidth=this.options.autoSize=="maxWidth"?false:this.options.autoSize;this.tablature.updateScale(this.options.zoom);if(this.options.layout!=null)this.options.layout.constructor==String?this.tablature.setViewLayoutByKey(this.options.layout):e.each(this.options.layout,function(b,c){b=="mode"?a.tablature.setViewLayoutByKey(c):a.tablature.setLayoutSetting(b,
c)});this.options.staves!=null&&e.each(this.options.staves,function(b,c){e.each(c,function(f,d){a.tablature.setStaveSetting(b,f,d)})});if(this.options.context==alphatab.platform.PlatformFactory.SVG_CANVAS)this.tablature.onFinished=function(){a.canvasWrapper.children().remove();var b=e(a.tablature.canvas.toSvg(true,"alphaTabSurface"));a.canvas=b;a.canvasWrapper.append(b)};if(this.options.file)this.loadFile(this.options.file);else if(this.contents!="")this.loadAlphaTex(this.contents);else if(this.options.context==
alphatab.platform.PlatformFactory.SVG_CANVAS){g=this.tablature.canvas;g.setWidth(this.options.width);g.setHeight(this.options.height);this.tablature.onFinished()}};alphaTabWrapper.fn=alphaTabWrapper.prototype;e.fn.alphaTab=function(i){for(var j=[],a=0;a<this.length;a++){if(!this[a].alphaTab)this[a].alphaTab=new alphaTabWrapper(this[a],i);j.push(this[a].alphaTab)}return j.length>1?j:j[0]}})(jQuery);document.write('<script type="text/vbscript">\nFunction VbAjaxLoader(method, fileName)\n\tDim xhr\n\tSet xhr = CreateObject("Microsoft.XMLHTTP")\n\n\txhr.Open method, fileName, False\n\n\txhr.setRequestHeader "Accept-Charset", "x-user-defined"\n\txhr.send\n\n\tDim byteArray()\n\n\tif xhr.Status = 200 Then\n\t\tDim byteString\n\t\tDim i\n\n\t\tbyteString=xhr.responseBody\n\n\t\tReDim byteArray(LenB(byteString))\n\n\t\tFor i = 1 To LenB(byteString)\n\t\t\tbyteArray(i-1) = AscB(MidB(byteString, i, 1))\n\t\tNext\n\tEnd If\n\n\tVbAjaxLoader=byteArray\nEnd Function\n<\/script>');
